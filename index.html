<!doctype html>
<html lang="ar" dir="rtl">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.rtl.min.css"
        integrity="sha384-gXt9imSW0VcJVHezoNQsP+TNrjYXoGcrqBZJpry9zJt8PCQjobwmhMGaDHTASo9N" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <title>مرحبا بالعالم!</title>
</head>

<body>
    <div id="loading">
        <img src="./imgs/Group 93181.svg" />
    </div>
    <div class="" style="text-align: center !important;">
        <div class="container">

            <!--
             <div class="row text-center">
                <div class="col-6">
                    <div class="row">مكانك الحالي</div>
                    <div class="row">محافظة
                        <span id="city"></span>
                    </div>
                </div>

                <div class="col-6">
                    <div class="row">الوقت المتوقع لفصل التيار</div>
                    <div class="row">من الساعة
                        الي الساعة
                    </div>
                </div>
            </div>
           -->
        </div>
    </div>
    <div class="p-5 mb-4 rounded-3 text-center">
        <div class="container-fluid py-5">
            <h1 class="display-5 fw-bold">
                <img src="./imgs/Group 93181.svg" />
            </h1>
            <p class="col-md-12 fs-4">
                ابحث بسهولة و اعرف مواعيد فصل التيار الكهربي عن منطقتك
            </p>
        </div>

        <div class="input-group">
            <input class="form-control form-control-lg" id="search" type="text" placeholder="ابحث باسم المنطقة السكنية"
                aria-label=".form-control-lg example">
            <button class="btn btn-serch btn-lg text-white" type="button" id="button-addon1">ابحث</button>


        </div>
        <ul class="list-group" id="result"></ul>

        <div class="result d-none mb-3 pb-3 pt-3 text-center">
            <img src="./imgs/bolt-slash.svg">
            <p>مواعيد فصل التيار الكهربي</p>
            <h3>
                من الساعة
                <span class="from"></span>
                الي الساعة
                <span class="to"></span>
            </h3>
        </div>

    </div>
    <footer class="text-center text-lg-start bg-light text-muted">
        <div class="text-center p-4" style="background-color: rgba(0, 0, 0, 0.05);">
            <div class="row justify-content-between">
                <div class="col-md-4">

                    <img src="./imgs/resources-3.svg" />
                    محمد حسبو
                    <a href="">
                        <i></i>
                    </a>
                    <a href="">
                        <i></i>
                    </a>
                </div>
                <div class="col-md-4">
                    <img src="./imgs/Group 93168.svg" />
                    محمد عبدالغفور
                    <a href="">
                        <i></i>
                    </a>
                    <a href="">
                        <i></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
    <script type="text/javascript" src="./data.json"></script>

    <script>
        setTimeout(function () {
            $('#loading').addClass('hidden');
        }, 2500);


        fetch('https://api.ipregistry.co/?key=8z9kpekcw2siaz0l&region=EG&language=ar')
            .then(function (response) {
                return response.json();
            })
            .then(function (payload) {
                $('#city').html(payload.location
                    .region
                    .name);
                console.log(payload.location.country.name + ', ' + payload.location.city + ', ' + payload.location
                    .region
                    .name);
                console.log(payload.location);
            });



        function readTextFile(file, callback) {
            var rawFile = new XMLHttpRequest();
            rawFile.overrideMimeType("application/json");
            rawFile.open("GET", file, true);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4 && rawFile.status == "200") {
                    callback(rawFile.responseText);
                }
            }
            rawFile.send(null);
        }
        readTextFile("./data.json", function (text) {
            var s = JSON.parse(text);
            data = s;
        });
    </script>

    <script>
        $(document).ready(function () {
            $.ajaxSetup({
                cache: false
            });
            $('#search').keyup(function () {
                $('#result').html('');
                $('#state').val('');
                var searchField = $('#search').val();
                var expression = new RegExp(searchField, "i");
                $.getJSON('./data.json', function (data) {
                    $.each(data, function (key, value) {
                        if (
                            value.gov.search(expression) != -1 ||
                            value.cityName.search(expression) != -1 ||
                            value.address.search(expression) != -1) {
                            $('#result').append(
                                '<li class="list-group-item link-class text-right" data-from = "' +
                                value.from + '" data-to = "' + value.to +
                                '" > <img src="./imgs/marker-9.svg" /> ' +

                                value.gov + ' ، ' +
                                value.cityName + ' ، ' +
                                value.address +
                                '</li>');
                        }
                    });
                });
            });

            $('#result').on('click', 'li', function () {
                var click_text = $(this).text().split('|');
                var from = $(this).data("from");
                var to = $(this).data("to");
                $('#search').val($.trim(click_text[0]));
                $("#result").html('');

                $(".result .from").html(from <= 12 ? from + ' صباحا' : from - 12 + ' مساء');
                $(".result .to").html(to <= 12 ? to + ' صباحا' : to - 12 + ' مساء');
                $(".result").removeClass('d-none');
            });
        });
    </script>

</body>

</html>